pipeline {
    agent any

    environment {
        MYSQL_ROOT_PASSWORD = credentials('mysql-root-pass')
        MYSQL_USER          = credentials('mysql-user')
        MYSQL_PASSWORD      = credentials('mysql-pass')
        SPRING_DATASOURCE_USERNAME = credentials('spring-db-user')
        SPRING_DATASOURCE_PASSWORD = credentials('spring-db-pass')
        DEEPSEEK_API_KEY    = credentials('deepseek-key')
        DEEPSEEK_API_URL    = credentials('deepseek-url')
    }

    stages {
        stage('Checkout') {
            steps {
                checkout scm
            }
        }

        stage('Build & Deploy') {
            steps {
                sh '''
                echo "Starting Docker Compose build and deploy"
                docker compose up --build -d
                '''
            }
        }
    }
}
